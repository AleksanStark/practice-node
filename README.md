# TASK 1

1. Створіть новий командний репозиторій на основі цього шаблонного репозиторію.
   Створений вами репозиторій ви будете використовувати на всіх подальших заняттях.
2. Додайте до нього в колаборатори всіх студентів вашої групи.
3. Налаштуйте захист на гілку `main`:

   - Увімкніть опцію "Require a pull request before merging";
   - Увімкніть опцію "Automatically delete head branches".

4. Склонуйте репозиторій на локальний комп'ютер.
5. Створіть гілку під свою задачу від гілки `main` та продовжуйте в ній виконувати завдання. Після завершення завдання змержте свою гілку в гілку `main`.
6. Проєкт має базову структуру і налаштування, які ви будете розширяти.
7. Створіть middleware для обробки помилок:
   - Створіть файл `src/middlewares/errorHandler.js`;
   - Застосуйте middleware `errorHandler` у файлі `src/server.js`;
   - Middleware `errorHandler` призначений для обробки помилок у вашому Express-сервері та має приймати чотири аргументи;
   - У разі виявлення помилки `errorHandler` має відправити клієнту відповідь зі статусом `500` та об’єкт з наступними властивостями:

```code
    {
        status: 500,
        message: "Something went wrong",
        data: <конкретне повідомлення про помилку, отримане з об'єкта помилки>
    }
```

8. Створіть і застосуйте у файлі `src/server.js` middleware `notFoundHandler`, призначений для обробки запитів, коли клієнт звертається до неіснуючого маршруту. `notFoundHandler` у разі виявлення помилки має відправити клієнту відповідь зі статусом 404 та об’єкт з наступними властивостями:

```code
    {
        message: "Route not found"
    }
```

# TASK 2

1. Створіть свій кластер в mongodb для колекції продуктів (`products`) та запишіть усі необхідні дані для його підключення у змінні оточення. Назви змінних візьми з файлу `env.example`.
2. Створіть функцію initMongoConnection в папці `db` і реалізуйте в ній підключення до бази даних за допомогою mongoose
3. В папці `src/db` створіть модель продукту `Product`, що буде включати в себе такі поля:

- name - string, required
- price - number, required
- category - string, enum('books', 'electronics', 'clothing', 'other'), required, default 'other'
- description - string, optional
- createdAt - дата створення
- updatedAt - дата оновлення

Для останніх двох полів достатньо використати параметр `timestamps: true` при створенні моделі.

Імпортуйте базовий набір продуктів із файлу `src/db/products.json` до вашої бази, користуючись будь-яким UI інтерфейсом (в браузері, Mongo Compass тощо). Переконайтеся, що назва колекції в коді моделі та в візуальному інтерфейсі співпадають.

# TASK 3

1. Створіть роут GET `/products` для отримання масиву усіх продуктів.

Обробка цього роута має включати:

- Реєстрацію роута в файлі `src/routers/products.js`
- Опис контролера для цього роута в файлі `src/controllers/products.js`
- Створення сервісу в файлі `src/services/products.js`
- Відповідь сервера має містити об’єкт з наступними властивостями:
  ```code
      {
          status: 200,
          message: "Successfully found products!",
          data: <масив продуктів>
      }
  ```

2. Створіть і застосуйте у файлі `src/routers/products.js` функцію `ctrlWrapper`, яка діятиме як обгортка для контролерів у вашому Express-додатку, для автоматичної обробки помилок, що можуть виникнути під час виконання запитів. В цій обгортці при виникненні помилки викличте next(err) для залучення middleware `errorHandler`.

# TASK 4

Створіть роут GET `/products/:productId` для отримання даних одного продукту по його ідентифікатору.

Обробка цього роута має включати:

- Реєстрацію роута в файлі `src/routers/products.js`
- Опис контролера для цього роута в файлі `src/controllers/products.js`
- Створення сервісу в файлі `src/services/products.js`
- Якщо за переданим ідентифікатором продукт було знайдено, то відповідь сервера має містити об’єкт з наступними властивостями:

```code
   {
       status: 200,
       message: "Successfully found product with id {productId}!",
       data: <об'єкт продукту>
   }
```

- Додайте перевірку чи продукт за переданим ідентифікатором було знайдено. Якщо продукт не було знайдено, то поверніть відповідь зі сатусом 404 і наступним об’єктом:

```code
   {
       message: "Product not found"
   }
```

# TASK 5\* (додаткове завдання)

Створіть роут POST `/products` для створення нового продукту. Тіло запиту має в себе включати наступні властивості:

- name - обов’язково;
- price - обов’язково;
- category - обов’язково;
- description - не обов’язково;

Обробка цього роута має включати:

- Реєстрацію роута в файлі `src/routers/products.js`
- Опис контролера для цього роута в файлі `src/controllers/products.js`
- Створення сервісу в файлі `src/services/products.js`
- При вдалому запиті відповідь сервера має містити об’єкт з наступними властивостями:

```code
   {
       status: 201,
       message: "Successfully created a product!",
       data: <об'єкт створеного продукту>
   }
```

# TASK 6\* (додаткове завдання)

Створіть роут PATCH `/products/:productId` для оновлення даних одного продукту по його ідентифікатору. Тіло запиту має в себе включати наступні властивості:

- name - не обов’язково;
- price - не обов’язково;
- category - не обов’язково;
- description - не обов’язково;

Обробка цього роута має включати:

- Реєстрацію роута в файлі `src/routers/products.js`
- Опис контролера для цього роута в файлі `src/controllers/products.js`
- Створення сервісу в файлі `src/services/products.js`
- Якщо за переданим ідентифікатором продукт було знайдено, то відповідь сервера має містити об’єкт з наступними властивостями:

```code
   {
       status: 200,
       message: "Successfully patched a product!",
       data: <оновлений об'єкт продукту>
   }
```

- Додайте перевірку чи продукт за переданим ідентифікатором було знайдено. Якщо продукт не було знайдено, то поверніть відповідь зі сатусом 404 і наступним об’єктом:

```code
   {
       message: "Product not found"
   }
```

# TASK 7\* (додаткове завдання)

Створіть роут DELETE `/products/:productId` для видалення одного продукту по його ідентифікатору.

Обробка цього роута має включати:

- Реєстрацію роута в файлі `src/routers/products.js`
- Опис контролера для цього роута в файлі `src/controllers/products.js`
- Створення сервісу в файлі `src/services/products.js`
- Відповідь сервера, в разі успішного видалення продукту, має бути зі статусом 204 без тіла відповіді

- Додайте перевірку чи продукт за переданим ідентифікатором було знайдено. Якщо продукт не було знайдено, , то поверніть відповідь зі сатусом 404 і наступним об’єктом:

```code
   {
       message: "Product not found"
   }
```
